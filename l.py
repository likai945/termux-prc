
dy={'ynSAEGWC1BZX':'APP-XNCDynSAEGWC1BZX-03AZX011','xjSAEGWC2BZX':'APP-XNCDxjSAEGWC2BZX-03AZX011','ynPCRF1BZX':'APP-XNCDynPCRF1BZX-03AZX011','ynMME1BZX':'APP-XNCDynMME1BZX-03AZX011','gsMME2BZX':'APP-XNCDgsMME2BZX-04AZX011','cqMME1BZX':'APP-XNCDcqMME1BZX-04AZX011','cqSAEGWC1BZX':'APP-XNCDcqSAEGWC1BZX-04AZX011','gsisbg2BZX':'APP-XNCDgsisbg2BZX-04AZX012','cqvoltetas1BZX':'APP-XNCDcqvoltetas1BZX-04AZX012','gspsbcc2BZX':'APP-XNCDgspsbcc2BZX-04AZX012','ynisbg1BZX':'APP-XNCDynisbg1BZX-03AZX012','cqisbg1BZX':'APP-XNCDcqisbg1BZX-04AZX012','cqPCRF1BZX':'APP-XNCDcqPCRF1BZX-04AZX011','nxMME2BZX':'APP-XNCDnxMME2BZX-04AZX011','gsPCRF2BZX':'APP-XNCDgsPCRF2BZX-04AZX011','nxPCRF2BZX':'APP-XNCDnxPCRF2BZX-04AZX011','ynvoltetas1BZX':'APP-XNCDynvoltetas1BZX-03AZX012','gsvoltetas2BZX':'APP-XNCDgsvoltetas2BZX-04AZX012','gsSAEGWC2BZX':'APP-XNCDgsSAEGWC2BZX-04AZX011','nxvoltetas2BZX':'APP-XNCDnxvoltetas2BZX-04AZX012','ynpsbcc1BZX':'APP-XNCDynpsbcc1BZX-03AZX012','nxpsbcc2BZX':'APP-XNCDnxpsbcc2BZX-04AZX012','xjpsbcc2BZX':'APP-XNCDxjpsbcc2BZX-03AZX012','xjisbg2BZX':'APP-XNCDxjisbg2BZX-03AZX012','cqpsbcc1BZX':'APP-XNCDcqpsbcc1BZX-04AZX012','nxSAEGWC2BZX':'APP-XNCDnxSAEGWC2BZX-04AZX011','nxisbg2BZX':'APP-XNCDnxisbg2BZX-04AZX012','cqmrfp1BZX':'APP-XNCDcqmrfp1BZX-04AZX012','xjmrfp2BZX':'APP-XNCDxjmrfp2BZX-03AZX012','ynmrfp1BZX':'APP-XNCDynmrfp1BZX-03AZX012','gsmrfp2BZX':'APP-XNCDgsmrfp2BZX-04AZX012','nxmrfp2BZX':'APP-XNCDnxmrfp2BZX-04AZX012','ynCG1BZX':'APP-XNCDynCG1BZX-03AZX011','gsCG2BZX':'APP-XNCDgsCG2BZX-04AZX011','cqCG1BZX':'APP-XNCDcqCG1BZX-04AZX011','xjCG2BZX':'APP-XNCDxjCG2BZX-03AZX011','nxCG2BZX':'APP-XNCDnxCG2BZX-04AZX011','cqimscg1BZX':'APP-XNCDcqimscg1BZX-04AZX012','ynimscg1BZX':'APP-XNCDynimscg1BZX-03AZX012','gsimscg2BZX':'APP-XNCDgsimscg2BZX-04AZX012','nximscg2BZX':'APP-XNCDnximscg2BZX-04AZX012','xjimscg2BZX':'APP-XNCDxjimscg2BZX-03AZX012','xjvoltetas2BZX':'APP-XNCDxjvoltetas2BZX-03AZX012','xjPCRF2BZX':'APP-XNCDxjPCRF2BZX-03AZX011','xjPCF2BZX':'APP-XNCDxjPCF004BZX-03AZX011','xqipsmgw1AZX':'APP-XNCDxqipsmgw1AZX-03AZX032','xqipsmgw2AZX':'APP-XNCDxqipsmgw2AZX-04AZX042','gsPCF004BZX':'APP-XNCDgsPCF004BZX-04AZX011','nxPCF004BZX':'APP-XNCDnxPCF004BZX-04AZ011','cqPCF003BZX':'APP-XNCDcqPCF003BZX-04AZX011','ynPCF001BZX':'APP-XNCDynPCF001BZX-03AZX011','xjMME2BZX':'APP-XNCDxjMME2BZX-03AZX011','xnq5GMC1AZX':'APP-XNCDxnq5GMC1AZX-04AZX011','cq5GMCSMSC1BZX':'APP-XNCDcq5GMCSMSC1BZX-04AZX011','gz5GMCSMSC1BZX':'APP-XNCDgz5GMCSMSC1BZX-04AZX011','gz5GMCSMSC3BZX':'APP-XNCDgz5GMCSMSC3BZX-04AZX012','xj5GMCSMSC2BZX':'APP-XNCDxj5GMCSMSC2BZX-04AZX012','sc5GMCSMSC1BZX':'APP-XNCDsc5GMCSMSC1BZX-04AZX011','yn5GMCSMSC3BZX':'APP-XNCDyn5GMCSMSC3BZX-04AZX012','xz5GMCSMSC1BZX':'APP-XNCDxz5GMCSMSC1BZX-04AZX012','gs5GMCSMSC2BZX':'APP-XNCDgs5GMCSMSC2BZX-04AZX011','gs5GMCSMSC4BZX':'APP-XNCDgs5GMCSMSC4BZX-04AZX012','sc5GMCSMSC3BZX':'APP-XNCDsc5GMCSMSC3BZX-04AZX012','sn5GMCSMSC4BZX':'APP-XNCDsn5GMCSMSC4BZX-04AZX012','sn5GMCSMSC6BZX':'APP-XNCDsn5GMCSMSC6BZX-04AZX011','yn5GMCSMSC1BZX':'APP-XNCDyn5GMCSMSC1BZX-04AZX011','qh5GMCSMSC2BZX':'APP-XNCDqh5GMCSMSC2BZX-04AZX012','nx5GMCSMSC2BZX':'APP-XNCDnx5GMCSMSC2BZX-04AZX012','sn5GMCSMSC2BZX':'APP-XNCDsn5GMCSMSC2BZX-04AZX011','NFVO':'西南NFVO','VNFM':'西南VNFM','VNFM03':'西南VNFM03','OMC':'西南OMC','gzAMFm003BZX':'APP-XNCDgzAMFm003BZX-05AZX012','snAMFm002BZX':'APP-XNCDsnAMFm002BZX-05AZX011','gsSMF004BZX':'APP-XNCDgsSMF004BZX-05AZX012','cqSMFm003BZX':'APP-XNCDcqSMFm003BZX-05AZX012','scSMFm001BZX':'APP-XNCDscSMFm001BZX-05AZX011','scSMFm003BZX':'APP-XNCDscSMFm003BZX-05AZX012','ynPCF001PCF001BZX':'APP-XNCDynPCF001PCF001BZX-05AZX012','gsSMF002BZX':'APP-XNCDgsSMF002BZX-05AZX011','xjSMF004BZX':'APP-XNCDxjSMF004BZX-05AZX012','nxAMF004BZX':'APP-XNCDnxAMF004BZX-05AZX012','gsCHF002BZX':'APP-XNCDgsCHF002BZX-05AZX011','nxCHF002BZX':'APP-XNCDnxCHF002BZX-05AZX011','ynSMFm003BZX':'APP-XNCDynSMFm003BZX-05AZX012','xjAMF002BZX':'APP-XNCDxjAMF002BZX-05AZX011','xjCHF002BZX':'APP-XNCDxjCHF002BZX-05AZX012','cqUDM004UDM001BZX':'APP-XNCDcqUDM004UDM001BZX-05AZX012','scUDM003UDM001BZX':'APP-XNCDscUDM003UDM001BZX-05AZX011','xjAMF004BZX':'APP-XNCDxjAMF004BZX-05AZX012','xbqPCFm001PUDR002AZX':'APP-XNCDxbqPCFm001PUDR002AZX-05AZX012','gzSMFm001BZX':'APP-XNCDgzSMFm001BZX-05AZX011','gsNSSF002BZX':'APP-XNCDgsNSSF002BZX-05AZX012','ynCHF001BZX':'APP-XNCDynCHF001BZX-05AZX011','nxAMF002BZX':'APP-XNCDnxAMF002BZX-05AZX011','nxSMF004BZX':'APP-XNCDnxSMF004BZX-05AZX012','ynPCF001PUDR001BZX':'APP-XNCDynPCF001PUDR001BZX-05AZX012','ynNSSF001BZX':'APP-XNCDynNSSF001BZX-05AZX012','xjNSSF002BZX':'APP-XNCDxjNSSF002BZX-05AZX011','nxSMF002BZX':'APP-XNCDnxSMF002BZX-05AZX011','qhAMFm002BZX':'APP-XNCDqhAMFm002BZX-05AZX011','cqCHFm001BZX':'APP-XNCDcqCHFm001BZX-05AZX012','gsAMF002BZX':'APP-XNCDgsAMF002BZX-05AZX011','gzPCF001PUDR001BZX':'APP-XNCDgzPCF001PUDR001BZX-05AZX012','cqUDM005UDM001BZX':'APP-XNCDcqUDM005UDM001BZX-05AZX011','cqUDM005UUDR001BZX':'APP-XNCDcqUDM005UUDR001BZX-05AZX011','cqUDM003UUDR001BZX':'APP-XNCDcqUDM003UUDR001BZX-05AZX011','gsUDM001UUDR002BZX':'APP-XNCDgsUDM001UUDR002BZX-05AZX011','cqUDM004UUDR001BZX':'APP-XNCDcqUDM004UUDR001BZX-05AZX012','cqUDM002UUDR001BZX':'APP-XNCDcqUDM002UUDR001BZX-05AZX012','qhCHFm002BZX':'APP-XNCDqhCHFm002BZX-05AZX012','cqUDM002UDM001BZX':'APP-XNCDcqUDM002UDM001BZX-05AZX012','cqSMFm001BZX':'APP-XNCDcqSMFm001BZX-05AZX011','cqUDM003UDM001BZX':'APP-XNCDcqUDM003UDM001BZX-05AZX011','gzPCF001PCF001BZX':'APP-XNCDgzPCF001PCF001BZX-05AZX012','scAMFm003BZX':'APP-XNCDscAMFm003BZX-05AZX012','ynSMF001BZX':'APP-XNCDynSMF001BZX-05AZX011','xbqSNRF002AZX':'APP-XNCDxbqSNRF002AZX-05AZX011','gsSMFm004BZX':'APP-XNCDgsSMFm004BZX-05AZX012','cqAMFm003BZX':'APP-XNCDcqAMFm003BZX-05AZX012','cqCHF001BZX':'APP-XNCDcqCHF001BZX-05AZX011','ynSMF003BZX':'APP-XNCDynSMF003BZX-05AZX012','gzSMFm003BZX':'APP-XNCDgzSMFm003BZX-05AZX012','scAMFm001BZX':'APP-XNCDscAMFm001BZX-05AZX011','xjSMFm002BZX':'APP-XNCDxjSMFm002BZX-05AZX011','gzAMFm001BZX':'APP-XNCDgzAMFm001BZX-05AZX011','xbqUDM001UDM000AZX':'APP-XNCDxbqUDM001UDM000AZX-05AZX012','gsAMFm004BZX':'APP-XNCDgsAMFm004BZX-05AZX012','xzAMFm003BZX':'APP-XNCDxzAMFm003BZX-05AZX012','xjSMF002BZX':'APP-XNCDxjSMF002BZX-05AZX011','qhSMFm002BZX':'APP-XNCDqhSMFm002BZX-05AZX011','qhSMFm004BZX':'APP-XNCDqhSMFm004BZX-05AZX012','gsAMF004BZX':'APP-XNCDgsAMF004BZX-05AZX012','scCHFm001BZX':'APP-XNCDscCHFm001BZX-05AZX012','cqNSSF001BZX':'APP-XNCDcqNSSF001BZX-05AZX012','nxAMFm002BZX':'APP-XNCDnxAMFm002BZX-05AZX011','xbqUDMm001UUDR002AZX':'APP-XNCDxbqUDMm001UUDR002AZX-05AZX011','xjSMFm004BZX':'APP-XNCDxjSMFm004BZX-05AZX012','xjAMFm004BZX':'APP-XNCDxjAMFm004BZX-05AZX012','xzSMFm001BZX':'APP-XNCDxzSMFm001BZX-05AZX011','xjCHFm002BZX':'APP-XNCDxjCHFm002BZX-05AZX012','nxAMFm004BZX':'APP-XNCDnxAMFm004BZX-05AZX012','nxSMFm004BZX':'APP-XNCDnxSMFm004BZX-05AZX012','nxSMFm002BZX':'APP-XNCDnxSMFm002BZX-05AZX011','xjAMFm002BZX':'APP-XNCDxjAMFm002BZX-05AZX011','nxCHFm002BZX':'APP-XNCDnxCHFm002BZX-05AZX011','gzCHFm001BZX':'APP-XNCDgzCHFm001BZX-05AZX012','cqAMF003BZX':'APP-XNCDcqAMF003BZX-05AZX012','nxNSSF002BZX':'APP-XNCDnxNSSF002BZX-05AZX012','snCHFm002BZX':'APP-XNCDsnCHFm002BZX-05AZX011','gsAMFm002BZX':'APP-XNCDgsAMFm002BZX-05AZX011','cqAMFm001BZX':'APP-XNCDcqAMFm001BZX-05AZX011','ynSMFm001BZX':'APP-XNCDynSMFm001BZX-05AZX011','xbqPCFm001PCF002AZX':'APP-XNCDxbqPCFm001PCF002AZX-05AZX012','xzSMFm003BZX':'APP-XNCDxzSMFm003BZX-05AZX012','cqAMF001BZX':'APP-XNCDcqAMF001BZX-05AZX011','ynAMF001BZX':'APP-XNCDynAMF001BZX-05AZX011','snSMFm004BZX':'APP-XNCDsnSMFm004BZX-05AZX012','xbqUDMm001UDM000AZX':'APP-XNCDxbqUDMm001UDM000AZX-05AZX011','cqUDM001UDM001BZX':'APP-XNCDcqUDM001UDM001BZX-05AZX011','xzCHFm001BZX':'APP-XNCDxzCHFm001BZX-05AZX011','cqUDM001UUDR001BZX':'APP-XNCDcqUDM001UUDR001BZX-05AZX011','ynAMFm003BZX':'APP-XNCDynAMFm003BZX-05AZX012','cqSMF007BZX':'APP-XNCDcqSMF007BZX-05AZX012','gsSMFm002BZX':'APP-XNCDgsSMFm002BZX-05AZX011','gsCHFm002BZX':'APP-XNCDgsCHFm002BZX-05AZX011','xzAMFm001BZX':'APP-XNCDxzAMFm001BZX-05AZX011','cqSMF001BZX':'APP-XNCDcqSMF001BZX-05AZX011','snSMFm002BZX':'APP-XNCDsnSMFm002BZX-05AZX011','scUDM003UUDR001BZX':'APP-XNCDscUDM003UUDR001BZX-05AZX011','snAMFm004BZX':'APP-XNCDsnAMFm004BZX-05AZX012','cqSMF003BZX':'APP-XNCDcqSMF003BZX-05AZX011','ynAMFm001BZX':'APP-XNCDynAMFm001BZX-05AZX011','ynCHFm001BZX':'APP-XNCDynCHFm001BZX-05AZX011','cqSMF005BZX':'APP-XNCDcqSMF005BZX-05AZX012','ynPCF002PUDR001BZX':'APP-XNCDynPCF002PUDR001BZX-05AZX012','ynAMF003BZX':'APP-XNCDynAMF003BZX-05AZX012','gsUDM001UDM000BZX':'APP-XNCDgsUDM001UDM000BZX-05AZX011','qhAMFm004BZX':'APP-XNCDqhAMFm004BZX-05AZX012','ynPCF002PCF001BZX':'APP-XNCDynPCF002PCF001BZX-05AZX012'}
import os


def shengcheng_sbm(chu, zhong, weizhi, kz):
    if os.path.exists(chu):
        k = kz
        wen = open(zhong, "a", encoding='utf_8_sig')
        for i in open(chu, encoding='utf_8_sig'):
            k += 1
            inkey = "no"
            vmn = i.split(",")[weizhi]
            if k > 1:
                if "-OMC-" in vmn:
                    sbm = "OMC"
                elif "-NFVO-" in vmn:
                    sbm = "NFVO"
                elif "-xnqVNFM3" in vmn:
                    sbm = "VNFM03"
                elif "-VNFM-" in vmn:
                    sbm = "VNFM"
                else:
                    psbm = vmn.split("-")[7]
                    if "ZX" in psbm:
                        sbm = str(psbm[:psbm.index("ZX")] + "ZX")
                    else:
                        sbm = psbm
                if sbm in dy:
                    sbm = dy[sbm]
                    inkey = "yes"
                vnfname = "," + sbm
                if inkey == "yes":
                    line = i.rstrip() + vnfname
                    wen.write(str(line) + "\n")


def hebing_wendang(jia, yi, qz):
    if os.path.exists(yi):
        if os.path.exists(jia):
            jiawen = open(jia, "a", encoding='utf_8_sig')
            q = qz
            for i in open(yi, encoding='utf_8_sig'):
                q += 1
                if q > 1:
                    jiawen.write(str(i.rstrip()) + "\n")
        else:
            os.rename(yi, jia)


def shan_wendang(wendang):
    if os.path.exists(wendang):
        os.remove(wendang)


def liebiao(chu, zhuti, panduan, quzhi):
    shengchenglb = []
    for i in open(chu, encoding='utf_8_sig'):
        lst = i.split(",")[panduan]
        fft = i.split(",")[quzhi]
        if lst == zhuti:
            shengchenglb.append(float(fft.strip('%')))
    return shengchenglb


def lbpingjun(lb):
    pingjun = sum(lb) / len(lb)
    return pingjun


def lbzuida(lb):
    zuida = max(lb)
    return zuida


def xunhuanlb(chu, shengchenglieming):
    jihe = set('')
    for i in open(chu, encoding='utf_8_sig'):
        lst = i.split(",")[shengchenglieming]
        jihe.add(lst)
    lbjihe = list(jihe)
    return lbjihe


def chuli(chu, zhong, panduan, quzhi, shengchenglieming, gongneng):
    if os.path.exists(chu):
        wen = open(zhong, "a", encoding='utf_8_sig')
        lbjihe = xunhuanlb(chu, shengchenglieming)
        for j in lbjihe:
            sclb = liebiao(chu, j, panduan, quzhi)
            if gongneng == "pjz":
                pingjunzhi = lbpingjun(sclb)
                pingjunzhi = str(pingjunzhi)
                j = j.rstrip('\n')
                hang = j + ',' + pingjunzhi
                wen.write(str(hang) + "\n")
            elif gongneng == "zdz":
                zuidazhi = lbzuida(sclb)
                zuidazhi = str(zuidazhi)
                j = j.rstrip('\n')
                hang = j + ',' + zuidazhi
                wen.write(str(hang) + "\n")


def zidian(chu):
    shengchengzd = {}
    for i in open(chu, encoding='utf_8_sig'):
        lst = i.split(",")[1]
        fst = i.split(",")[0]
        shengchengzd[fst] = lst
    return shengchengzd


def shengcheng_yingshe(chu, zhong):
    if os.path.exists(chu):
        wen = open(zhong, "a", encoding='utf_8_sig')
        sczd = zidian("fz.csv")
        for i in open(chu, encoding='utf_8_sig'):
            vnfname = i.split(",")[0]
            line = i.rstrip("\n") + "," + sczd[vnfname].rstrip("\n")
            wen.write(str(line) + "\n")


#######program#######

shan_wendang("jzfz.csv")
print("Old files cleaned yet.")
hebing_wendang(jia="kx41.csv", yi="kx42.csv", qz=0)
shengcheng_sbm(chu="kx3.csv", zhong="sbmkx3.csv", weizhi=3, kz=0)
shengcheng_sbm(chu="kx41.csv", zhong="sbmkx4.csv", weizhi=3, kz=0)
shengcheng_sbm(chu="kx5.csv", zhong="sbmkx5.csv", weizhi=3, kz=0)
print("SBM files done.")
shan_wendang("kx3.csv")
shan_wendang("kx41.csv")
shan_wendang("kx42.csv")
shan_wendang("kx5.csv")
chuli("sbmkx3.csv", "jz3.csv", 7, 4, 7, "pjz")
print("Average of kx3 out.")
chuli("sbmkx4.csv", "jz4.csv", 7, 4, 7, "pjz")
print("Average of kx4 out.")
chuli("sbmkx5.csv", "jz5.csv", 7, 4, 7, "pjz")
print("Average of kx5 out.")
print("Long time to wait, just have a relax :)")
chuli("sbmkx3.csv", "zj3.csv", 3, 4, 3, "zdz")
chuli("sbmkx4.csv", "zj4.csv", 3, 4, 3, "zdz")
chuli("sbmkx5.csv", "zj5.csv", 3, 4, 3, "zdz")
shengcheng_sbm("zj3.csv", "zd3.csv", 0, 1)
shengcheng_sbm("zj4.csv", "zd4.csv", 0, 1)
shengcheng_sbm("zj5.csv", "zd5.csv", 0, 1)
chuli("zd3.csv", "fz3.csv", 2, 1, 2, "pjz")
print("Max of kx3 out.")
chuli("zd4.csv", "fz4.csv", 2, 1, 2, "pjz")
print("Max of kx4 out.")
chuli("zd5.csv", "fz5.csv", 2, 1, 2, "pjz")
print("Max of kx5 out.")
hebing_wendang("fz3.csv", "fz4.csv", 1)
hebing_wendang("fz3.csv", "fz5.csv", 1)
os.rename("fz3.csv", "fz.csv")
hebing_wendang("jz3.csv", "jz4.csv", 1)
hebing_wendang("jz3.csv", "jz5.csv", 1)
os.rename("jz3.csv", "jz.csv")
shengcheng_yingshe("jz.csv", "jzfz.csv")
print("Done!")
shan_wendang("sbmkx3.csv")
shan_wendang("sbmkx4.csv")
shan_wendang("sbmkx5.csv")
shan_wendang("zj3.csv")
shan_wendang("zj4.csv")
shan_wendang("zj5.csv")
shan_wendang("zd3.csv")
shan_wendang("zd4.csv")
shan_wendang("zd5.csv")
shan_wendang("jz4.csv")
shan_wendang("jz5.csv")
shan_wendang("fz4.csv")
shan_wendang("fz5.csv")
shan_wendang("fz.csv")
shan_wendang("jz.csv")
