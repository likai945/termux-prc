#/bin/bash
cha(){
[ `cat $jl | wc -l` -eq 0 ] && echo -e "\t\t\033[31mNO DATA\033[0m" && exit 
zc=`date +%j`
sc=`tail -1 ${jl} | awk '{print $1}'`
d=`expr $zc - $sc`
[ $d -lt 0 ] && d=$[365+d]
[ $d -eq 1 ] && echo -e "\n\033[32m$d\033[0m day no shit" || echo -e "\n\033[32m$d\033[0m days no shit"
}
lan(){
tail=`tail -1 ${jl}`
et=${tail:18}
length=`echo $et | wc -L` 
echo -en "\033[?25l"
for x in `seq ${length}`;do
	echo -en "\033[$[x%7+31]m-"
	sleep 0.001
done
echo
for i in `seq ${length}`;do
	echo -en "\033[32m${et:$[i-1]:1}\033[0m"
	sleep 0.01
done
echo
for x in `seq ${length}`;do
	echo -en "\033[$[x%7+31]m-"
	sleep 0.001
done
echo -e "\033[?25h\n\033[0m"
}
ji(){
zheci=`date +%j`
shangci=$(tail -1 ${jl} | awk '{print $1}')
[ -z $shangci ] && delay=0 || delay=`expr $zheci - $shangci - 1`
[ $delay -eq -1 ] &>/dev/null && echo -e "\t\t\033[31mDUPLICATE RECORD\033[0m" && exit 
[ $delay -lt -1 ] && delay=$[365+delay]
shi=`date +%s`
echo -e "\033[32m\ntime recording...\ncomplete all after poop\nremark 'manual' if necessary\033[0m\n"
read -p 'the scale(nml):' s
bi=`date +%s`
read -p 'easy or difficult(eas):' e
read -p 'color(brn):' c
read -p 'remark(-):' r
t=$[(bi-shi)/60]
[ $[(bi-shi)%60/6] -ge 5 ] && let t++
rl=$[`echo $r | wc -L`+10]
[[ $r == manual* ]] &>/dev/null && read -p 'time(8min):' t && r=`echo ${r:6} | sed 's/ //g'` && rl=$[`echo $t | wc -L`+11]
[ $t -lt 10 ] &>/dev/null && t=0$t
echo "${zheci} d${delay} `date +%R` `date +%Y` `date +%b` `date +%d` `date +%a` | ${s:=nml} ${e:=eas} ${c:=brn} ${t:=08}min ${r:=-}" >> ${jl}
cp $jl /data/data/com.termux/files/usr/Termuxbak/backup/hm/ && echo -e "\033[1A\033[${rl}C\033[32m[âœ“]\033[0m\n"
}
quan(){
if [ `cat $jl | wc -l` -eq 0 ];then
	echo -e "\t\t\033[31mNO DATA\033[0m"
	else
	echo -e '\n\033[32m------------------------------\033[0m'
	cat ${jl}
	echo -e '\033[32m------------------------------\033[0m\n'
fi
}
bei(){
cp $jl /data/data/com.termux/files/usr/Termuxbak/backup/hm/ && echo -e '\t\t\033[32mBACKUP COMPLETED\033[0m'
}
##########the program##########
jl=/data/data/com.termux/files/home/jl
[ ! -f $jl ] && touch $jl
case $1 in 
	--cha|-c|c)
	cha;
	lan;;
	--ji|-j|j)
	ji;
	lan;;
	--quan|-q|q)
	quan;;
	--bei|-b|b)
	bei;;
	*)
	echo "cha|ji|quan|bei"
esac
